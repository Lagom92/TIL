# SQL

SQL 전문가 가이드 2010 Edition을 공부한 내용을 정리했다.

<br/>

## SQL(Structured Query Language)

데이터베이스를 직접적으로 액세스 할 수 있는 언어

데이터를 정의(Data Definition)

조작(Data Manipulation)

조작한 결과를 적용하거나 취소할 수 있고(Transaction Control)

접근 권한을 제어(Data Control) 처리들로 구성된다.



<br/>

# 과목 1. 데이터 모델링의 이해

## 1. 데이터 모델의 이해

### 1. 모델링의 이해

1. 모델링의 정의

   - 모델을 만들어 가는 일
   - 복잡한 '현실세계'를 단순화시켜 표현하는 것
   - 모델이란 사물 또는 사건에 관한 양상(Aspect)이나 관점(Perspective)을 연관된 사람이나 그룹을 위하여 명확하게 하는 것

   

   <br/>

2. 모델링의 특징

   - 추상화, 단순화, 명확화

   1. 추상화

      다양한 현상을 일정한 양식인 표기법에 의해 표현한다는 것

   2. 단순화

      복잡한 현실세계를 약속된 규약에 의해 제한된 표기법이나 언어로 표현하여 쉽게 이해할 수 있도록 하는 개념

   3. 명확화

      누구나 이해하기 쉽게 하기 위해 대상에 대한 애매모호함을 제거하고 정확하게 현상을 기술하는 것

   <br/>

   즉, 모델링은 현실세계를 추상화, 단순화, 명확화 하기 위해 일정한 표기법에 의해 표현하는 기법이라고 할 수 있다.

   정보 시스템 구축에서는 모델링을 계획, 분석, 설계 할 때 업무를 분석하고 설계하는데 이용하고 이후 구축, 운영 단계에서는 변경과 관리의 목적으로 이용하게 된다.

   

   <br/>

3. 모델링의 세 가지 관점

   - 데이터 관점, 프로세스 관점, 데이터와 프로셋의 상관관점

   <br/>

   1. 데이터 관점

      업무가 어떤 데이터와 관련이 있는지 또는 데이터간의 관계는 무엇인지에 대해서 모델링하는 방법(What, Data)

   2. 프로세스 관점

      - 업무가 실제하고 있는 일은 무엇인지 또는 무엇을 해야 하는지를 모델링 하는 방법(How, Process)

   3. 데이터와 프로세스의 상관관점

      - 업무가 처리하는 일의 방법에 따라 데이터는 어떻게 영향을 받고 있는지 모델링하는 방법(Interaction)
   
      
      
      <br/>

### 2. 데이터 모델의 기본 개념의 이해

1. 데이터 모델링의 정의

   - 정보시스템을 구축하기 위해 해당 업무에 어떤 데이터가 존재하는지 또는 업무가 필요로 하는 정보는 무엇인지를 분석하는 방법
   - 기업 업무에 대한 종합적인 이해를 바탕으로 데이터에 존재하는 업무 규칙(Business Rule)에 대하여 참 또는 거짓을 판별할 수 있는 사실(사실명제)을 데이터에 접근하는 방법(How), 사람(Who), 전산화와는 별개의(독립적인)관점에서 이를 명확하게 표현하는 추상화 기법

   

   <br/>

   업무에서 필요로 하는 데이터를 시스템 구축 방법론에 의해 분석하고 설계하여 정보시스템을 구축하는 과정으로 정의할 수 있다.

   <br/>

   데이터 모델링을 하는 주요한 이유

   1. 업무정보를 구성하는 기초가 되는 정보들을 일정한 표기법에 의해 표현함으로써 정보시스템 구축의 대상이 되는 업무 내용을 정확하게 분석하는 것
   2. 분석된 모델을 가지고 실제 데이터베이스를 생성하여 개발 및 데이터관리에 사용하기 위한 것

   <br/>

   데이터 모델링은 단지 데이터베이스만을 구축하기 위한 용도로만 쓰이는 것이 아니라 데이터 모델링 자체로서 업무를 설명하고 분석하는 부분에도 매우 중요한 의미를 가지고 있다.

   <br/>

   ```
   데이터 모델링이란 ?
   
   - 정보시스템을 구축하기 위한 데이터관점의 업무 분석 기법
   
   - 현실세계의 데이터(What)에 대해 약속된 표기법에 의해 표현하는 과정
   
   - 데이터베이스를 구축하기 위한 분석/설계의 과정
   ```

   

​      <br/>

2.  데이터 모델이 제공하는 기능
   - 시스템을 현재 또는 원하는 모습으로 가시화하도록 도와준다.
   - 시스템의 구조와 행동을 명세화 할 수 있게 한다.
   - 시스템을 구축하는 구조화된 틀을 제공한다.
   - 시스템을 구축하는 과정에서 결정한 것을 문서화한다.
   - 다양한 영역에 집중하기 위해 다른 영역의 세부 사항은 숨기는 다양한 관점을 제공한다.
   - 특정 목표에 따라 구체화된 상세 수준의 표현방법을 제공한다.



 <br/>

### 3. 데이터 모델링의 중요성 및 유의점

데이터 모델링이 중요한 이유

파급효과, 복잡한 정보 요구사항의 간결한 표현, 데이터 품질

<br/>

1. 파급효과(Leverage)

   시스템이 구축되어 가면서 많은 단위테스트를 하고 병행테스트, 통합테스트를 수행 하게 된다. 이러한 과정 중에서 데이터 모델의 변경이 불가피한 상황이 발생한다면 데이터 구조의 변경에 따른 표준 영향 분석, 응용 변경 영향 분석 등 많은 영향 분석이 일어난다. 그 이후에 해당 분야의 실제적인 변경 작업이 발생하게 된다. 즉, 데이터 구조의 변경으로 인한 일련의 변경작업은 전체 시스템 구축  프로젝트에서 큰 위험요소가 된다. 그래서  데이터 설계가 중요하다.

   <br/>

2. 복잡한 정보 요구사항의 간결한 표현(Conciseness)

   데이터 모델은 구축할 시스템의 정보 요구사항과 한계를 가장 명확하고 간결하게 표현할 수 있는 도구이다. 정보 요구사항을 파악하는 좋은 방법은 데이터 모델을 리뷰하면서 파악하는 것 이다. 데이터 모델은 시스템을 구축하는 많은 관련자들이 설계자의 생각대로 정보요구사항을 이해하고 이를 운용할 수 있는 애플리케이션을 개발하고 데이터 정합성을 유지할 수 있도록 하는 것이다. 모델이 갖추어야 할 가장 중요한 점은 정보 요구사항이 정확하고 간결하게 표현되어야 한다는 것이다.

   <br/>

3. 데이터 품질(Ddata Quality)

   데이터 품질의 문제는 초기에는 인지를 못하다가 시간이 지나고 데이터의 양이 많아 지면서 이를 사용하려고 할때 문제가 될 수 있다. 중복 데이터의 미정의, 데이터 구조의 비즈니스 정의의 불충분, 동일한 성격의 데이터를 통합하지 않고 분리함으로써의 나타나는 데이터 불일치 등의 데이터 구조의 문제로 인한 데이터 품질 문제는 발생 하지 않도록 해야 한다.

   <br/>

   - 데이터 모델링을 할 때 유의점

     1. 중복(Duplication)

        데이터 모델은 같은 데이터를 사용하는 사람, 시간, 그리고 장소를 파악하는데 도움을 준다. 이러한 지식 응용은 데이터가 여러 장소에 같은 정보를 저장하는 잘못을 하지 않도록 한다. 

     2. 비유연성(Inflexbility)

        데이터 모들을 어떻게 설계했느냐에 따라 사소한 업무변화에도 데이터 모델이 수시로 변경됨으로써 유지보수의 어려움을 가중시킬 수 있다. 데이터의 정의를 데이터의 사용 프로세스와 분리함으로써 데이터 모델링은 데이터 혹은 프로세스의 작은 변화가 애플리케이션과 데이터베이스에 중대한 변화를 일으킬 수 있는 가능성을 줄인다.

     3. 비일관성(Inconsistency)

        데이터의 중복이 없더라도 비일관성은 발생한다. 개발자가 다른 데이터와 모순된다는 고려 없이 일련의 데이터를 수정 할 수 있기 때문이다. 데이터 모델링을 할 때 데이터와 데이터간 상호 연관 관계에 대한 명확한 정의는 이러한 위험을 사전에 예방 할 수 있도록 해준다.
        
        <br/>


### 4. 데이터 모델링의 3단계 진행

데이터베이스가 만들어지는 과정은 추상화 수준에 따라 개념적 데이터 모델, 논리적 데이터 모델, 물리적 데이터 모델로 정리 할 수 있다.

<br/>

- 개념 - 논리 - 물리 데이터 모델

| 데이터 모델링        | 내용                                                         |
| -------------------- | ------------------------------------------------------------ |
| 개념적 데이터 모델링 | 추상화 수준이 높고 업무중심적이고 포괄적인 수준의 모델링 진행, 전사적 데이터 모델링, EA수립시 많이 이용 |
| 논리적 데이터 모델링 | 시스템으로 구축하고자 하는 업무에 대해 Key, 속성, 관계 등을 정확하게 표현, 재사용성이 높음 |
| 물리적 데이터 모델링 | 실제로 데이터베이스에 이식할 수 있도록 성능, 저장 등 물리적인 성격을 고려하여 설계 |

<br/>

개념적 데이터 모델링이 가장 추상적이고 물리적 데이터 모델링이 가장 구체적이다.

<br/>

1. 개념적 데이터 모델링(Conceptual Data Modeling)

   - 개념적 데이터베이스 설계(개념 데이터 모델링)는 조직, 사용자의 데이터 요구사항을 찾고 분석하는데서 시작한다.
   - 어떤 자료가 중요하고 어떤 자료가 유지되어야 하는지 결정하는것도 포함된다.
   - 핵심 엔티티와 그들 간의 관계를 발견하고 엔티티-관계 다이어그램을 생성 한다.
   - 엔티티-관계 다이어그램은 조직과 다양한 데이터베이스 사용자에게 어떠한 데이터가 중요한지 나타내기 위해서 사용된다.
   - 데이터 모델링 과정이 전 조직에 걸쳐 일루어진다면 그것은 전사적 데이터 모델(Enterprise Data Model)이라고 불린다.
   - 조직의 데이터 요구를 공식화 하는것의 기능
     1. 개념 데이터 모델은 사용자와 시스템 개발자가 데이터 요구 사항을 발견하는 것을 지원한다.
     2. 개념 데이터 모델은 현 시스템이 어떻게 변형되어야 하는가를 이해하는데 유용하다.

   <br/>

2. 논리적 데이터 모델링(Logical Data Modeling)

   - 데이터베이스 설계 프로세스의 Input으로써 비즈니스 정보의 논리적인 구조와 규칙을 명확하게 표현하는 기법 또는 과정

   - 누가(Who), 어떻게(How: Process) 그리고 전산화와는 별개로 비즈니스 데이터에 존재하는 사실들을 인식하여 기록하는 것

   - 데이터 모델링 과정에서 가장 핵심이 되는 부분이 논리 데이터 모델링이라고 할 수 있다.

     ///이어서 20 page



​				













--------------

<br/>

# 과목 2. SQL 기본 및 활용

<br/>

- DDL을 통해 데이터를 만든 후, DML을 통해 데이터를 조작하고, SELECT 문장을 통해 요구 사항에 맞는 데이터를 출력한다.
- 테이블과 테이블 간의 관계를 구현하기 위해 JOIN과 서브쿼리 등 다양한 SQL의 관계 구현 방법을 사용한다.
- SQL 최적화를 위한 옵티마이저와 인덱스의 기초 원리를 이해한다.

<br/>

## 1. SQL 기본

146 page

<br/>

### 1. 관계형 데이터베이스 개요

1. 데이터 베이스

   - 데이터 베이스
     - 일반적으로 특정 기업이나 조직 또는 개인이 필요에 의해(ex) 부가가치가 발생하는) 데이터를 일정한 형태로 저장해 놓은 것
   - DBMS(Database Management System)
     - 많은 사용자들은 보다 효율적인 데이터의 관리 뿐만 아니라 예기치 못한 사건으로 인한 데이터의 손상을 피하고, 필요시 필요한 데이터를 복구하기 위한 강력한 기능의 소프트웨어를 필요로 하게 되었고 이러한 기본적인 요구사항을 만족시켜주는 시스템
   - 데이터베이스의 발전
   - 관계형 데이터베이스(Relational Database)

   148 page

   <br/>

2. SQL(Structured Query Language)

   - 관계형 데이터베이스에서 데이터 정의, 데이터 조작, 데이터 제어를 하기 위해 사용하는 언어

   - 일반적인 프로그래밍 언어와는 달리 SQL은 관계형 데이터베이스에 대한 전담 접속(다른 언어는 관계형 데이터베이스에 접속할 수 없다) 용도로 사용되며 세미콜론(;)으로 분리되어 있는 SQL 문장 단위로 독립되어 있다.

   - 관계형 데이터베이스는 수학의 집합 논리에 입각한 것이므로 SQL도 데이터를 집합으로써 취급한다.

   - SQL 문장들의 종류

     | 명령어의 종류        | 명령어                                  | 설명                                                         |
     | -------------------- | --------------------------------------- | ------------------------------------------------------------ |
     | 데이터 조작어(DML)   | SELECT                                  | 데이터베이스에 들어 있는 데이터를 조회하거나 검색하기 위한 명령어를 말하는 것으로 RETRIEVE 라고도 한다. |
     |                      | INSERT<br />UPDATE<br />DELETE          | 데이터베이스의 테이블에 들어 있는 데이터에 변형을 가하는 종류의 명령어들을 말한다. 예를 들어 데이터를 테이블에 새로운 행을 집어넣거나 원하지 않는 데이터를 삭제하거나 수정하는 것들의 명령어들을 DML이라고 부른다. |
     | 데이터 정의어(DDL)   | CREATE<br />ALTER<br />DROP<br />RENAME | 테이블과 같은 데이터 구조를 정의하는데 사용되는 명령어들로 그러한 구조를 생성하거나 변경하거나 삭제하거나 이름을 바꾸는 데이터 구조와 관련된 명령어들을 DDL이라고 부른다. |
     | 데이터 제어어(DCL)   | GRANT<br />REVOKE                       | 데이터베이스에 접근하고 객체들을 사용하도록 권한을 주고 회수하는 명령어를 DCL이라고 부른다. |
     | 트랜잭션 제어어(TCL) | COMMIT<br />ROLLBACK                    | 논리적인 작업의 단위를 묶어서 DML에 의해 조작된 결과를 작업단위(트랜잭션) 별로 제어하는 명령어를 말한다. |

   - SQL 명령어는 3가지 SAVEPOINT 그룹인 DDL, DML, DCL로 나눌 수 있는데, TCL의 경우 굳이 나눈다면 일부에서 DCL로 분류하기도 하지만, 다소 성격이 다르므로 별도의 4번째 그룹으로 분리할 것을 권고한다.

   <br/>

3. TABLE

   - 데이터는 관계형 데이터베이스의 기본 단위인 테이블 형태로 저장된다.
   
   - 모든 자료는 테이블에 등록이 되고 우리는 테이블로부터 원하는 자료를 꺼내 올 수 있다.
   
   - 테이블은 어느 특정한 주제와 목적으로 만들어지는 일종의 집합이다.
   
   - 테이블은 데이터를 저장하는 객체(Object)로서 관계형 데이터베이스의 기본 단위이다.
   
   - 관계형 데이터베이스에서는 모든 데이터를 칼럼과 행의 2차원 구조로 나타낸다.
   
   - 세로 방향을 칼럼(Column), 가로 방향을 행(Row)이라고 하고, 칼럼과 행이 겹치는 하나의 공간을 필드(Field)라고 한다.
   
     #### 테이블 용어
   
     | 용어            | 설명                                                         |
     | --------------- | ------------------------------------------------------------ |
     | 테이블(Table)   | 행과 칼럼의 2차원 구조를 가진 데이터의 저장 장소이며, 데이터베이스의 가장 기본적인 개념 |
     | 칼럼/열(Column) | 2차원 구조를 가진 테이블에서 세로 방향으로 이루어진 하나하나의 특정 속성(더이상 나눌 수 없는 특성) |
     | 행(Row)         | 2차원 구조를 가진 테이블에서 가로 방향으로 이루어진 연결된 데이터 |
   
   
   
   - 테이블을 분할하여 데이터의 불필요한 중복을 줄이는 것을 정규화(Normalization) 라고 한다.
   
   - 데이터의 정합성 확보와 데이터 입력/수정/삭제시 발생할 수 있는 이상현상(Anomaly)을 방지하기 위해 정규화는 관계형 데이터베이스 모델링에서 매우 중요한 프로세스이다.
   
   - 키본키(Primary Key): 각 행을 한 가지 의미로 특정할 수 있는 한 개 이상의 칼럼
   
   - 외부키(Foreign Key): 다른 테이블의 기본 키로 사용되면서 테이블과의 관계를 연결하는 역할을 하는 칼럼
   
     #### 테이블 관계 용어들
   
     | 용어                  | 설명                                                         |
     | --------------------- | ------------------------------------------------------------ |
     | 정규화(Normalization) | 테이블을 분할하여 데이터의 정합성을 확보하고, 불필요한 중복을 줄이는 프로세스 |
     | 기본키(Primary Key)   | 테이블에 존재하는 각 행을 한 가지 의미로 특정할 수 있는 한 개 이상의 칼럼 |
     | 외부키(Foreign Key)   | 다른 테이블의 기본키로 사용되고 있는 관계를 연결하는 칼럼    |



<br/>

4. ERD(Entity Relationship Diagram)
   - 관계의 의미를 직관적으로 표현할 수 있는 수단
   - ERD 구성 요서
     - 엔티티(ENtity)
     - 관계(Relationship)
     - 속성(Attribute)



<br/>

### 2. DDL(Data Definition Language)

1. 데이터 유형

   - 특정 칼럼을 정의할 때 선언한 데이터 유형은 그 칼럼이 받아들일 수 있는 자료의 유형을 규정한다.

   - 선언한 유형이 아닌 다른 종류의 데이터가 들어오려고 하면 데이터베이스는 에러를 발생시킨다.

   - 데이터 유형과 더불어 지정한 크기(SIZE)도 중요한 기능을 제공한다.

   - 선언 당시에 지정한 데이터의 크기를 넘어선 자료가 입력되는 상황도 에러를 발생시키는 중요한 요인이다.

   - 데이터베이스에서 사용하는 데이터 유형은 다양한 형태로 제공된다.

     #### 자주 쓰이는 데이터 유형

     | 데이터 유형  | 설명                                                         |
     | ------------ | ------------------------------------------------------------ |
     | CHARACTER(s) | - 고정 길이 문자열 정보 (Oracle, SQL Server 모두 CHAR로 표현)<br />- s는 기본 길이 1바이트, 최대 길이 Oracle 2000 바이트, SQL Server 8000 바이트<br />- s 만큼 최대 길이를 갖고 고정 길이를 가지고 있으므로 할당된 변수 값의 길이가 s보다 작을 경우에는 그 차이 길이만큼 공간으로 채워진다. |
     | VARCHAR(s)   | - CHARACTER VARYING의 약자로 가변 길이 문자열 정보 (Oracle은 VARCHAR2로 표현, SQL Server는 VARCHAR로 표현)<br />- s는 최소 길이 1바이트, 최대 길이 Oracle  4000 바이트, SQL Server 8000 바이트<br />- s만큼의 최대 길이를 갖지만 가변 길이로 조정이 되기 때문에 할당된 변수값의 바이트만 적용된다 (Limit 개념) |
     | NUMERIC      | - 정수, 실수 등 숫자 정보(Oracle은 NUMBER로, SQL Server는 10가지 이상의 숫자 타입을 가지고 있음)<br />- Oracle은 처음에 전체 자리 수를 지정하고, 그 다음 소수 부분의 자리 수를 지정한다. 예를 들어, 정수 부분이 6자리이고 소수점 부분이 2자리인 경우 'NUMBER(8,2)'와 같이 된다. |
     | DATETIME     | - 날짜와 시각 정보(Oracle은 DATE로 표현, SQL Server는 DATETIME으로 표현)<br />- Oracle은 1초 단위, SQL Server는 3.33ms(millisecond) 단위 관리 |

     

   - CHAR 유형과 VARCHAR 유형 비교
  - VARCHAR 유형은 가변 길이이므로 필요한 영역은 실제 데이터 크기뿐이다.
     - 그래서, 길이가 다양한 칼럼과 정의된 길이와 실제 데이터 길이에 차이가 있는 칼럼에 적합하다.
  - 저장 측면에서도 CHAR 유형보다 작은 영역에 저장할 수 있으므로 장점이 있다.
     - CHAR에서는 문자열을 비교할 때 공백(BLANK)을 채워서 비교하는 방법을 사용한다.공백 채우기 비교에서는 우선 짧은 쪽의 끝에 공백을 추가하여 2개의 데이터가 같은 길이가 되도록 한다. 그리고 앞에서 부터 한 문자씩 비교한다. 그렇기 때문에 끝의 공백만 다른 문자열은 같다고 판단된다.
     - VARCHAR 유형에서는 맨 처음부터 한 문자씩 비교하고 공백도 하나의 문자로 취급하므로 끝의 공백이 다르면 다른 문자로 판단한다. 
     - 자료들이 고정된 길이의 문자열을 가지지 않는다면 데이터 유형은 VARCHAR 유형을 적용하는 것이 바람직하다.(ex) VARCHAR(40))
   
   - CHAR가 아닌 VARCHAR, NUMERIC 유형에서 정의한 길이나 자릿수의 의미는 해당 데이터 유형이 가질 수 있는 최대한의 한계값을 정의한 것이라고 보아야 한다.
   - 문자열(CHAR와 VARCHAR)에 대한 최대 길이와 NUMBER 칼럼의 정밀도(Precision)를 지정하는 것은 테이블 설계시 반드시 고려해야 할 중요 요소이다.
   
   
   
   <br/>
   
2. CREATE TABLE

   - 테이블은 일정한 형식에 의해서 생성된다. 테이블 생성을 위해서는 해당 테이블에 입력될 데이터를 정의하고, 정의한 데이터를 어떠한 데이터 유형으로 선언할 것인지를 결정해야 한다.

   

   1. 테이블과 칼럼 정의
      - 









<br/>

### 3. DML



<br/>

### 4. TCL



<br/>

### 5. WHERE 절



<br/>

### 6. 함수(FUNCTION)



<br/>

### 7. GROUP BY, HAVING 절



<br/>

### 8. ORDER BY 절



<br/>

### 9. JOIN(조인)











<br/>

## 2. SQL 활용

300 page





<br/>

## 3. SQL 최적화 기본 원리

444 page



